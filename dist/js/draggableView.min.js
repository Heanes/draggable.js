/*
 * draggableView - v1.0.0 - 2018-09-11 17:12:04 Tuesday
 * https://github.com/heanes/draggableView.js
 * Copyright (c) 2018 Heanes
 * Licensed MIT License
 */

"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(v,f,e,a){var i="draggableView",r={};r.setting={title:'<h2 class="content-title">拖拽一下试试</h2>',showStatusBar:!1,wrapType:1,enableDrag:!0,dragDirection:"all",dragLimitTop:0,dragLimitLeft:0,dragLimitBottom:0,dragLimitRight:0,enableResize:!0,enableDirectionKeyToMove:!0,directionKeyDownToMoveOffset:1,resizeMinWidth:150,resizeMinHeight:150,resizeMaxWidth:500,resizeMaxHeight:500,dragContentWrap:{padding:"18px",bgColor:"#ddedf1",borderWidth:"10px",borderColor:"#a0b3d6",borderStyle:"solid"},dragMoveBar:{height:"80px",padding:"0 10px",bgColor:"#258cef",color:"#fff",borderTopWidth:"20px",borderBottomWidth:"20px",borderLeftWidth:"20px",borderRightWidth:"20px",borderStyle:"solid",borderColor:"#c9e7e4",fontSize:"14px"},dragBorder:{topSize:"60px",bottomSize:"60px",leftSize:"60px",rightSize:"60px",topColor:"#efdfed",bottomColor:"#ceb455",leftColor:"#cdef75",rightColor:"#a7bbef",bgColor:"rgba(240, 243, 249, 0.44)"},dragWrap:{borderWidth:"30px",borderStyle:"solid",borderColor:"rgba(248, 233, 104, 0.42)",boxShadow:"rgba(130, 130, 130, 0.5) 0px 0px 4px 2px",borderRadius:"8px"},onWindowMove:a};var d=function(e,t){return this.$element=v(e),this._defaults=r,this._name=i,this.version="v1.0.0",this.init(t),{options:this.options,init:v.proxy(this.init,this),remove:v.proxy(this.remove,this),setValue:v.proxy(this.setValue,this),test:v.proxy(this.test,this)}};function m(e,t){t&&(t.width&&e.css({width:t.width}),t.height&&e.css({height:t.height}))}function B(e,t){(t.top||t.left)&&e.css({position:"fixed"}),t.top&&e.css({top:t.top+"px"}),t.left&&e.css({left:t.left+"px"})}function c(e){var t=0,r=0;return e&&(t=e.offset().top,r=e.offset().left),{top:t,left:r}}function b(e){if(e)return{outerWidth:e.outerWidth(),outerHeight:e.outerHeight()}}function u(e){e.on("selectstart",function(e){e.stopPropagation()}),e.css("user-select","none")}function n(e){f.console&&f.console.error(e)}d.prototype.init=function(e){return this.checkIsInitialized()||(this.options=v.extend(!0,{},r.setting,e),this.inElement={$originContent:a,$dragWrap:a,$dragContentWrap:a,$dragOperateWrap:a,$dragMoveBar:a,$dragBorder:a,$dragBorderTop:a,$dragBorderBottom:a,$dragBorderLeft:a,$dragBorderRight:a,$dragBorderTopLeft:a,$dragBorderTopRight:a,$dragBorderBottomLeft:a,$dragBorderBottomRight:a,$dratStatusWrap:a},this.data={origin:{originContent:{width:0,height:0,top:0,left:0},dragContentWrap:{width:0,height:0},dragMoveBar:{width:0,height:0},dragBorder:{horizontalWidth:0,verticalHeight:0,cornerTopLeft:{width:0,height:0},cornerTopRight:{width:0,height:0},cornerBottomLeft:{width:0,height:0},cornerBottomRight:{width:0,height:0}},dragWrap:{width:0,height:0,left:0,top:0}},calculated:{originContent:{width:0,height:0,top:0,left:0},dragContentWrap:{width:0,height:0},dragMoveBar:{width:0,height:0},dragBorder:{horizontalWidth:0,verticalHeight:0,cornerTopLeft:{width:0,height:0},cornerTopRight:{width:0,height:0},cornerBottomLeft:{width:0,height:0},cornerBottomRight:{width:0,height:0}},dragWrap:{width:0,height:0,left:0,top:0}},dynamic:{dragFlag:!1,resizeFlag:!1,resizeBorderPlace:"",mouseDownPosition:{X:0,Y:0},currentPosition:{left:0,top:0},moveOffset:{offsetX:0,offsetY:0},moveOffsetTotal:{offsetX:0,offsetY:0}}},this.render(this.options)),this},d.prototype.checkIsInitialized=function(e){return!!this.$element.hasClass("draggable-view-initialized")},d.prototype.render=function(e){return this.calculateRenderSize(e),this.buildDom(e),this.injectStyle(e),this.showStatusInfo(e),this.bindMouseEvent(e),this.bindWindowMoveEvent(e),this.bindKeyEvent(e),this},d.prototype.bindMouseEvent=function(r){var o=this,a=this.data.dynamic;return v(e).on("mousemove",function(e){var t=e||f.event;(r.enableDrag||r.enableResize)&&((a.dragFlag||a.resizeFlag)&&(a.moveOffset.offsetX=t.clientX-a.mouseDownPosition.X,a.moveOffset.offsetY=t.clientY-a.mouseDownPosition.Y),o.mouseMoveToDrag(r),o.mouseMoveToResize(r))}),v(e).on("mouseup",function(){r.enableDrag&&a.dragFlag&&(a.dragFlag=!1),r.enableResize&&a.resizeFlag&&(a.resizeFlag=!1),o.inElement.$dragWrap.css("user-select","auto")}),this.bindDrag(r),this.bindResize(r),this},d.prototype.checkCanDrag=function(e){if(e.enableDrag||e.enableResize)return!1},d.prototype.calculateMoveOffset=function(e){var t=this.data.origin,r=this.data.dynamic,o=this.data.calculated;r.moveOffsetTotal.offsetX=o.dragWrap.left-t.dragWrap.left,r.moveOffsetTotal.offsetY=o.dragWrap.top-t.dragWrap.top},d.prototype.bindWindowMoveEvent=function(t){var r=this;this.inElement.$dragWrap.on("move",function(e){r.calculateMoveOffset(t)}),"function"==typeof t.onWindowMove&&this.inElement.$dragWrap.on("move",this.options.onWindowMove)},d.prototype.bindDrag=function(e){if(!e.enableDrag)return this;var o=this,a=this.data.dynamic;return o.inElement.$dragMoveBar.on("mousedown",function(e){a.dragFlag=!0;var t=e||f.event;a.mouseDownPosition.X=t.clientX,a.mouseDownPosition.Y=t.clientY;var r=c(o.inElement.$dragWrap);a.currentPosition.left=r.left,a.currentPosition.top=r.top}),this},d.prototype.mouseMoveToDrag=function(e){var t=this.data.dynamic,r=this.data.calculated;if(e.enableDrag&&t.dragFlag){u(this.inElement.$dragWrap),"y"===this.options.dragDirection.toLowerCase()&&(t.moveOffset.offsetY=0),"x"===this.options.dragDirection.toLowerCase()&&(t.moveOffset.offsetX=0);var o={top:t.currentPosition.top+t.moveOffset.offsetY,left:t.currentPosition.left+t.moveOffset.offsetX};B(this.inElement.$dragWrap,o),r.dragWrap.top=o.top,r.dragWrap.left=o.left,this.inElement.$dragWrap.trigger("move"),this.showStatusInfo(e)}return this},d.prototype.bindKeyEvent=function(e){return this.bindDirectionKeyToMove(e),this},d.prototype.bindDirectionKeyToMove=function(o){if(!o.enableDirectionKeyToMove||o.directionKeyDownToMoveOffset<=0)return this;var a=this,i=this.data.dynamic;return v(e).on("keydown",function(e){var t=e||f.event;38===t.keyCode&&(i.dragFlag=!0,i.moveOffset.offsetY=-o.directionKeyDownToMoveOffset,i.moveOffset.offsetX=0,a.mouseMoveToDrag(o)),40===t.keyCode&&(i.moveOffset.offsetY=o.directionKeyDownToMoveOffset,i.moveOffset.offsetX=0,i.dragFlag=!0,a.mouseMoveToDrag(o)),37===t.keyCode&&(i.dragFlag=!0,i.moveOffset.offsetX=-o.directionKeyDownToMoveOffset,i.moveOffset.offsetY=0,a.mouseMoveToDrag(o)),39===t.keyCode&&(i.dragFlag=!0,i.moveOffset.offsetX=o.directionKeyDownToMoveOffset,i.moveOffset.offsetY=0,a.mouseMoveToDrag(o));var r=c(a.inElement.$dragWrap);i.currentPosition.left=r.left,i.currentPosition.top=r.top}),v(e).on("keyup",function(e){var t=e||f.event;37!==t.keyCode&&38!==t.keyCode&&39!==t.keyCode&&40!==t.keyCode||(i.dragFlag=!1)}),this},d.prototype.bindResize=function(e){if(!e.enableDrag)return this;var h=this,p=this.data.dynamic,l=this.data.calculated;return h.inElement.$dragBorder.on("mousedown",function(e){p.resizeFlag=!0;var t=e||f.event,r=v(t.target);r.hasClass("drag-border-top")&&(p.resizeBorderPlace="top"),r.hasClass("drag-border-bottom")&&(p.resizeBorderPlace="bottom"),r.hasClass("drag-border-left")&&(p.resizeBorderPlace="left"),r.hasClass("drag-border-right")&&(p.resizeBorderPlace="right"),r.hasClass("drag-border-top-left")&&(p.resizeBorderPlace="top-left"),r.hasClass("drag-border-top-right")&&(p.resizeBorderPlace="top-right"),r.hasClass("drag-border-bottom-left")&&(p.resizeBorderPlace="bottom-left"),r.hasClass("drag-border-bottom-right")&&(p.resizeBorderPlace="bottom-right"),p.mouseDownPosition.X=t.clientX,p.mouseDownPosition.Y=t.clientY;var o=c(h.inElement.$dragWrap);p.currentPosition.left=o.left,p.currentPosition.top=o.top;var a=b(h.inElement.$dragWrap),i=b(h.inElement.$dragContentWrap),d=b(h.inElement.$originContent),n=b(h.inElement.$dragMoveBar),s=b(h.inElement.$dragBorderTop),g=b(h.inElement.$dragBorderLeft);l.dragWrap.width=a.outerWidth,l.dragWrap.height=a.outerHeight,l.dragContentWrap.width=i.outerWidth,l.dragContentWrap.height=i.outerHeight,l.originContent.width=d.outerWidth,l.originContent.height=d.outerHeight,l.dragMoveBar.width=n.outerWidth,l.dragBorder.verticalHeight=g.outerHeight,l.dragBorder.horizontalWidth=s.outerWidth}),h},d.prototype.mouseMoveToResize=function(e){var t=this,r=this.data.dynamic,o=this.data.calculated;if(e.enableResize&&r.resizeFlag){u(t.inElement.$dragWrap);var a={},i={},d={},n={},s={},g={},h={},p=!1,l=r.moveOffset,f=l.offsetX,c=l.offsetY;"top-left"!==r.resizeBorderPlace&&"top-right"!==r.resizeBorderPlace&&"bottom-left"!==r.resizeBorderPlace&&"bottom-right"!==r.resizeBorderPlace||(p=!0),(p||"top"===r.resizeBorderPlace||"bottom"===r.resizeBorderPlace)&&("top"!==r.resizeBorderPlace&&"top-left"!==r.resizeBorderPlace&&"top-right"!==r.resizeBorderPlace||(c=0-c),i.height=o.dragWrap.height+c,d.height=o.dragContentWrap.height+c,n.height=o.originContent.height+c,g.height=o.dragBorder.verticalHeight+c,"top"!==r.resizeBorderPlace&&"top-left"!==r.resizeBorderPlace&&"top-right"!==r.resizeBorderPlace||(a.top=r.currentPosition.top+l.offsetY)),(p||"left"===r.resizeBorderPlace||"right"===r.resizeBorderPlace||"bottom-left"===r.resizeBorderPlace)&&("left"!==r.resizeBorderPlace&&"top-left"!==r.resizeBorderPlace&&"bottom-left"!==r.resizeBorderPlace||(f=0-f),i.width=o.dragWrap.width+f,d.width=o.dragContentWrap.width+f,s.width=o.dragMoveBar.width+f,n.width=o.originContent.width+f,h.width=o.dragBorder.horizontalWidth+f,"left"!==r.resizeBorderPlace&&"top-left"!==r.resizeBorderPlace&&"bottom-left"!==r.resizeBorderPlace||(a.left=r.currentPosition.left+l.offsetX)),"top"!==r.resizeBorderPlace&&"left"!==r.resizeBorderPlace&&"top-left"!==r.resizeBorderPlace&&"top-right"!==r.resizeBorderPlace&&"bottom-left"!==r.resizeBorderPlace||B(t.inElement.$dragWrap,a),m(t.inElement.$dragWrap,i),m(t.inElement.$dragContentWrap,d),m(t.inElement.$originContent,n),m(t.inElement.$dragMoveBar,s),m(t.inElement.$dragBorderTop,h),m(t.inElement.$dragBorderBottom,h),m(t.inElement.$dragBorderLeft,g),m(t.inElement.$dragBorderRight,g),this.showStatusInfo(e)}return this},d.prototype.calculateRenderSize=function(e){var t=c(this.$element),r=b(this.$element),o=this.data.origin,a=this.data.dynamic;o.originContent={width:r.outerWidth,height:r.outerHeight,top:t.top,left:t.left};var i=o.originContent.width+2*parseInt(e.dragContentWrap.padding)+2*parseInt(e.dragContentWrap.borderWidth),d=o.originContent.height+2*parseInt(e.dragContentWrap.padding)+2*parseInt(e.dragContentWrap.borderWidth);return o.dragContentWrap={width:i,height:d},o.dragMoveBar={width:o.dragContentWrap.width,height:parseInt(e.dragMoveBar.height)+parseInt(e.dragMoveBar.borderTopWidth)+parseInt(e.dragMoveBar.borderTopWidth)},o.dragBorder={horizontalWidth:o.dragContentWrap.width-2*parseInt(e.dragContentWrap.borderWidth),verticalHeight:o.dragContentWrap.height+o.dragMoveBar.height-2*parseInt(e.dragContentWrap.borderWidth),cornerTopLeft:{width:parseInt(e.dragBorder.leftSize)+parseInt(e.dragContentWrap.borderWidth),height:parseInt(e.dragBorder.topSize)+parseInt(e.dragContentWrap.borderWidth)},cornerTopRight:{width:parseInt(e.dragBorder.rightSize)+parseInt(e.dragContentWrap.borderWidth),height:parseInt(e.dragBorder.topSize)+parseInt(e.dragContentWrap.borderWidth)},cornerBottomLeft:{width:parseInt(e.dragBorder.leftSize)+parseInt(e.dragContentWrap.borderWidth),height:parseInt(e.dragBorder.bottomSize)+parseInt(e.dragContentWrap.borderWidth)},cornerBottomRight:{width:parseInt(e.dragBorder.rightSize)+parseInt(e.dragContentWrap.borderWidth),height:parseInt(e.dragBorder.topSize)+parseInt(e.dragContentWrap.borderWidth)}},o.dragWrap={width:i+parseInt(e.dragBorder.leftSize)+parseInt(e.dragBorder.rightSize)+2*parseInt(e.dragWrap.borderWidth),height:d+parseInt(e.dragBorder.topSize)+parseInt(e.dragBorder.bottomSize)+o.dragMoveBar.height+2*parseInt(e.dragWrap.borderWidth),top:o.originContent.top-(parseInt(e.dragContentWrap.padding)+parseInt(e.dragContentWrap.borderWidth)+parseInt(e.dragBorder.topSize)+parseInt(e.dragWrap.borderWidth)+o.dragMoveBar.height),left:o.originContent.left-(parseInt(e.dragContentWrap.padding)+parseInt(e.dragContentWrap.borderWidth)+parseInt(e.dragBorder.leftSize)+parseInt(e.dragWrap.borderWidth))},a.currentPosition.top=o.dragWrap.top,a.currentPosition.left=o.dragWrap.left,this.data.calculated=function e(t){var r={};for(var o in t)t.hasOwnProperty(o)&&(r[o]="object"===_typeof(t[o])?e(t[o]):t[o]);return r}(o),this},d.prototype.buildDom=function(e){var t=v(this.template.dragWrap),r=v(this.template.dragOperateWrap),o=v(this.template.dratStatusWrap),a=v(this.template.dratStatusBar),i=v(this.template.dragMoveBar);i.append(this.options.title);var d=v(this.template.dragBorderTop),n=v(this.template.dragBorderBottom),s=v(this.template.dragBorderLeft),g=v(this.template.dragBorderRight),h=v(this.template.dragBorderTopLeft),p=v(this.template.dragBorderTopRight),l=v(this.template.dragBorderBottomLeft),f=v(this.template.dragBorderBottomRight);r.append(i).append(h).append(d).append(p).append(s).append(g).append(l).append(n).append(f);var c=v(this.template.dragContentWrap);this.$element.wrap(c),this.$element.addClass("draggable-view-initialized").addClass("draggable-view-content");var m=this.$element.parent();m.wrap(t);var B=m.parent();return B.prepend(r),B.append(o.append(a)),this.inElement.$originContent=this.$element,this.inElement.$dragWrap=B,this.inElement.$dragContentWrap=m,this.inElement.$dragOperateWrap=r,this.inElement.$dratStatusWrap=o,this.inElement.$dragStatusInfo=a,this.inElement.$dragMoveBar=i,this.inElement.$dragBorder=B.find(".drag-border"),this.inElement.$dragBorderTop=d,this.inElement.$dragBorderBottom=n,this.inElement.$dragBorderLeft=s,this.inElement.$dragBorderRight=g,this.inElement.$dragBorderTopLeft=h,this.inElement.$dragBorderTopRight=p,this.inElement.$dragBorderBottomLeft=l,this.inElement.$dragBorderBottomRight=f,this},d.prototype.injectStyle=function(e){var t=this.data.origin;this.data.dynamic;this.inElement.$originContent.css({left:"unset",top:"unset"}),this.inElement.$dragContentWrap.css({left:e.dragBorder.leftSize,bottom:e.dragBorder.bottomSize,width:t.dragContentWrap.width+"px",height:t.dragContentWrap.height+"px",border:e.dragContentWrap.borderWidth+" "+e.dragContentWrap.borderStyle+" "+e.dragContentWrap.borderColor,padding:e.dragContentWrap.padding,"background-color":e.dragContentWrap.bgColor}),this.inElement.$dragMoveBar.css({left:e.dragBorder.leftSize,top:e.dragBorder.bottomSize,width:t.dragMoveBar.width+"px",height:t.dragMoveBar.height+"px","line-height":parseInt(t.dragMoveBar.height-parseInt(e.dragMoveBar.borderTopWidth)-parseInt(e.dragMoveBar.borderTopWidth))+"px",padding:e.dragMoveBar.padding,"border-style":e.dragMoveBar.borderStyle,"border-color":e.dragMoveBar.borderColor,"border-top-width":e.dragMoveBar.borderTopWidth,"border-bottom-width":e.dragMoveBar.borderTopWidth,"border-left-width":e.dragMoveBar.borderTopWidth,"border-right-width":e.dragMoveBar.borderRightWidth,color:e.dragMoveBar.color,"background-color":e.dragMoveBar.bgColor}),this.inElement.$dragBorder.css({}),this.inElement.$dragBorderTop.css({left:t.dragBorder.cornerTopLeft.width+"px",width:t.dragBorder.horizontalWidth+"px",height:e.dragBorder.topSize,"background-color":e.dragBorder.topColor}),this.inElement.$dragBorderBottom.css({left:t.dragBorder.cornerBottomLeft.width+"px",width:t.dragBorder.horizontalWidth+"px",height:e.dragBorder.bottomSize,"background-color":e.dragBorder.bottomColor}),this.inElement.$dragBorderLeft.css({top:t.dragBorder.cornerTopLeft.height+"px",width:e.dragBorder.leftSize,height:t.dragBorder.verticalHeight+"px","background-color":e.dragBorder.leftColor}),this.inElement.$dragBorderRight.css({top:t.dragBorder.cornerTopRight.height+"px",width:e.dragBorder.rightSize,height:t.dragBorder.verticalHeight+"px","background-color":e.dragBorder.rightColor}),this.inElement.$dragBorderTopLeft.css({width:t.dragBorder.cornerTopLeft.width+"px",height:t.dragBorder.cornerTopLeft.height+"px","border-top-left-radius":e.dragWrap.borderRadius}),this.inElement.$dragBorderTopRight.css({width:t.dragBorder.cornerTopRight.width+"px",height:t.dragBorder.cornerTopRight.height+"px","border-top-right-radius":e.dragWrap.borderRadius}),this.inElement.$dragBorderBottomLeft.css({width:t.dragBorder.cornerBottomLeft.width+"px",height:t.dragBorder.cornerBottomLeft.height+"px","border-bottom-left-radius":e.dragWrap.borderRadius}),this.inElement.$dragBorderBottomRight.css({width:t.dragBorder.cornerBottomRight.width+"px",height:t.dragBorder.cornerBottomRight.height+"px","border-bottom-right-radius":e.dragWrap.borderRadius}),this.inElement.$dragWrap.css({left:t.dragWrap.left+"px",top:t.dragWrap.top+"px",width:t.dragWrap.width+"px",height:t.dragWrap.height+"px",border:e.dragWrap.borderWidth+" "+e.dragWrap.borderStyle+" "+e.dragWrap.borderColor,"border-radius":e.dragWrap.borderRadius,"box-shadow":e.dragWrap.boxShadow})},d.prototype.showStatusInfo=function(e){if(!e.showStatusBar)return this;var t=this.inElement.$dragStatusInfo,r=this.data.dynamic,o='<span class="info-item move-offset-info"><span class="field">x :</span><span class="value">'+r.moveOffset.offsetX+'<span><span class="field">y :</span><span class="value">'+r.moveOffset.offsetY+"</span></span>",a='<span class="info-item move-offset-total-info"><span class="field">x :</span><span class="value">'+r.moveOffsetTotal.offsetX+'<span><span class="field">y :</span><span class="value">'+r.moveOffsetTotal.offsetY+"</span></span>";t.empty().append(o).append(a)},d.prototype.template={dragWrap:'<div class="drag-wrap">',dragContentWrap:'<div class="drag-content-wrap">',dragOperateWrap:'<div class="drag-operate-wrap"></div>',dragMoveBar:'<div class="drag-move-bar"></div>',dragBorderTop:'<div class="drag-border drag-border-top"></div>',dragBorderBottom:'<div class="drag-border drag-border-bottom"></div>',dragBorderLeft:'<div class="drag-border drag-border-left"></div>',dragBorderRight:'<div class="drag-border drag-border-right"></div>',dragBorderTopLeft:'<div class="drag-border drag-border-top-left"></div>',dragBorderTopRight:'<div class="drag-border drag-border-top-right"></div>',dragBorderBottomLeft:'<div class="drag-border drag-border-bottom-left"></div>',dragBorderBottomRight:'<div class="drag-border drag-border-bottom-right"></div>',dratStatusWrap:'<div class="drag-status-wrap"></div>',dratStatusBar:'<div class="drag-status-bar"></div>',dragOpMinSize:'<div class="drag-op-min-size"></div>',dragOpMaxSize:'<div class="drag-op-max-size"></div>',dragOpCloseView:'<div class="drag-op-close-view"></div>'},v.fn[i]=function(t,r){var o=a;return this.each(function(){var e=v.data(this,i);"string"==typeof t?e?v.isFunction(e[t])&&"_"!==t.charAt(0)?(r instanceof Array||(r=[r]),o=e[t].apply(e,r)):n("No such method : "+t):n("Not initialized, can not call method : "+t):"boolean"==typeof t?o=e:v.data(this,i,new d(this,v.extend(!0,{},t)))}),o||this}}(jQuery,window,document);
//# sourceMappingURL=draggableView.js.map